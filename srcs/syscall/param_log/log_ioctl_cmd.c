#define _GNU_SOURCE

#include "param_log.h"
#include <sys/ioctl.h>
#include <termios.h>

static const flag_str_t ioctl_cmd_flags[] = {
	FLAG_STR(TCGETS),
	FLAG_STR(TCSETS),
	FLAG_STR(TCSETSW),
	FLAG_STR(TCSETSF),
	FLAG_STR(TCGETA),
	FLAG_STR(TCSETA),
	FLAG_STR(TCSETAW),
	FLAG_STR(TCSETAF),
	FLAG_STR(TCSBRK),
	FLAG_STR(TCXONC),
	FLAG_STR(TCFLSH),
	FLAG_STR(TIOCEXCL),
	FLAG_STR(TIOCNXCL),
	FLAG_STR(TIOCSCTTY),
	FLAG_STR(TIOCGPGRP),
	FLAG_STR(TIOCSPGRP),
	FLAG_STR(TIOCOUTQ),
	FLAG_STR(TIOCSTI),
	FLAG_STR(TIOCGWINSZ),
	FLAG_STR(TIOCSWINSZ),
	FLAG_STR(TIOCMGET),
	FLAG_STR(TIOCMBIS),
	FLAG_STR(TIOCMBIC),
	FLAG_STR(TIOCMSET),
	FLAG_STR(TIOCGSOFTCAR),
	FLAG_STR(TIOCSSOFTCAR),
	FLAG_STR(FIONREAD),
	FLAG_STR(TIOCLINUX),
	FLAG_STR(TIOCCONS),
	FLAG_STR(TIOCGSERIAL),
	FLAG_STR(TIOCSSERIAL),
	FLAG_STR(TIOCPKT),
	FLAG_STR(FIONBIO),
	FLAG_STR(TIOCNOTTY),
	FLAG_STR(TIOCSETD),
	FLAG_STR(TIOCGETD),
	FLAG_STR(TCSBRKP),
	FLAG_STR(TIOCSBRK),
	FLAG_STR(TIOCCBRK),
	FLAG_STR(TIOCGSID),
	FLAG_STR(TIOCGRS485),
	FLAG_STR(TIOCSRS485),
	FLAG_STR(TIOCGPTN),
	FLAG_STR(TIOCSPTLCK),
	FLAG_STR(TIOCGDEV),
	FLAG_STR(TCGETX),
	FLAG_STR(TCSETX),
	FLAG_STR(TCSETXF),
	FLAG_STR(TCSETXW),
	FLAG_STR(TIOCSIG),
	FLAG_STR(TIOCVHANGUP),
	FLAG_STR(TIOCGPKT),
	FLAG_STR(TIOCGPTLCK),
	FLAG_STR(TIOCGEXCL),
	FLAG_STR(TIOCSERCONFIG),
	FLAG_STR(TIOCSERGWILD),
	FLAG_STR(TIOCSERSWILD),
	FLAG_STR(TIOCGLCKTRMIOS),
	FLAG_STR(TIOCSLCKTRMIOS),
	FLAG_STR(TIOCSERGSTRUCT),
	FLAG_STR(TIOCSERGETLSR),
	FLAG_STR(TIOCSERGETMULTI),
	FLAG_STR(TIOCSERSETMULTI),
	FLAG_STR(TIOCMIWAIT),
	FLAG_STR(TIOCGICOUNT),
	FLAG_STR(FIOQSIZE),
	FLAG_STR(TIOCINQ),
	FLAG_STR(TIOCPKT_DATA),
	FLAG_STR(TIOCPKT_FLUSHREAD),
	FLAG_STR(TIOCPKT_FLUSHWRITE),
	FLAG_STR(TIOCPKT_STOP),
	FLAG_STR(TIOCPKT_START),
	FLAG_STR(TIOCPKT_NOSTOP),
	FLAG_STR(TIOCPKT_DOSTOP),
	FLAG_STR(TIOCPKT_IOCTL),
};

int log_IOCTL_CMD(uint64_t value)
{
	return option_log(value, ioctl_cmd_flags, sizeof(ioctl_cmd_flags) / sizeof(ioctl_cmd_flags[0]), "0x%lx");
}
